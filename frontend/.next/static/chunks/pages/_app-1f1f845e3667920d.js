(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[636],{92:(e,t,o)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return o(1760)}])},1760:(e,t,o)=>{"use strict";o.r(t),o.d(t,{default:()=>a});var r=o(7876);o(4232);var n=o(5593);o(4467),o(5379);let a=function(e){let{Component:t,pageProps:o}=e;return(0,r.jsx)(n.O,{children:(0,r.jsx)(t,{...o})})}},2605:(e,t,o)=>{"use strict";o.d(t,{vF:()=>n});class r{createLogEntry(e,t,o){return{level:e,message:t,timestamp:new Date().toISOString(),url:window.location.href,userAgent:"undefined"!=typeof navigator?navigator.userAgent:"",context:o}}log(e,t,o){let r=this.createLogEntry(e,t,o);if(this.logs.push(r),this.logs.length>100&&this.logs.shift(),this.isDevelopment){let r="error"===e?"error":"warn"===e?"warn":"info"===e?"info":"log";console[r]("[".concat(e.toUpperCase(),"] ").concat(t),o||"")}this.isDevelopment||"error"!==e||this.sendToBackend(r).catch(()=>{})}async sendToBackend(e){try{await fetch("/api/logs",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}catch(e){}}error(e,t){this.log("error",e,t)}warn(e,t){this.log("warn",e,t)}info(e,t){this.log("info",e,t)}debug(e,t){this.isDevelopment&&this.log("debug",e,t)}logUserAction(e,t,o){this.info("User action: ".concat(e),{action:e,data:t,userId:o,component:"user_action"})}logApiCall(e,t,o,r){let n=r||o&&o>=400?"error":"info",a="API call: ".concat(e," ").concat(t),i={action:"api_call",component:"api",url:t,data:{method:e,status:o}};r&&(i.error=r),this.log(n,a,i)}logPageView(e,t){this.info("Page view: ".concat(e),{action:"page_view",component:"navigation",userId:t,data:{page:e}})}logError(e,t,o){this.error("Error in ".concat(t||"unknown component",": ").concat(e.message),{component:t,error:e,data:o})}getRecentLogs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.logs.slice(-e)}clearLogs(){this.logs=[]}constructor(){this.logs=[],this.isDevelopment=!1}}window.addEventListener("error",e=>{n.logError(e.error,"global",{filename:e.filename,lineno:e.lineno,colno:e.colno})}),window.addEventListener("unhandledrejection",e=>{n.logError(Error(e.reason||"Unhandled Promise Rejection"),"promise",{reason:e.reason})});let n=new r},3578:(e,t,o)=>{"use strict";o.d(t,{S:()=>n});let r=o(5364).env.NEXT_PUBLIC_API_URL||"/api",n={AUTH_LOGIN:"".concat(r,"/auth/login"),AUTH_REGISTER:"".concat(r,"/auth/register"),AUTH_ME:"".concat(r,"/auth/me"),RECIPES:"".concat(r,"/recipes"),RECIPE_DELETE:e=>"".concat(r,"/recipes/").concat(e),CATEGORIES:"".concat(r,"/categories"),TAGS:"".concat(r,"/tags"),MEDIA_UPLOAD:"".concat(r,"/media"),RATINGS:"".concat(r,"/ratings"),COMMENTS:"".concat(r,"/comments")}},4467:()=>{},5379:()=>{},5593:(e,t,o)=>{"use strict";o.d(t,{A:()=>l,O:()=>c});var r=o(7876),n=o(4232),a=o(3578),i=o(2605);let s=(0,n.createContext)(void 0),l=()=>{let e=(0,n.useContext)(s);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},c=e=>{let{children:t}=e,[o,l]=(0,n.useState)(null),[c,g]=(0,n.useState)(null),[d,h]=(0,n.useState)(!0);(0,n.useEffect)(()=>{(async()=>{let e=localStorage.getItem("token");if(e)try{let t=await fetch(a.S.AUTH_ME,{headers:{Authorization:"Bearer ".concat(e),"Content-Type":"application/json"}});if(t.ok){let o=await t.json();l(o),g(e)}else localStorage.removeItem("token"),g(null)}catch(e){i.vF.logError(e,"AuthContext.initializeAuth"),localStorage.removeItem("token"),g(null)}h(!1)})()},[]);let u=async(e,t)=>{try{i.vF.logUserAction("login_attempt",{username:e});let o=await fetch(a.S.AUTH_LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:t})});if(!o.ok){let t=await o.json();throw i.vF.logUserAction("login_failed",{username:e,error:t.detail}),Error(t.detail||"Login failed")}let r=(await o.json()).access_token;localStorage.setItem("token",r),g(r),i.vF.logUserAction("login_success",{username:e});let n=await fetch(a.S.AUTH_ME,{headers:{Authorization:"Bearer ".concat(r),"Content-Type":"application/json"}});if(n.ok){let e=await n.json();l(e),i.vF.logUserAction("user_data_loaded",{userId:e.id})}}catch(e){throw i.vF.logError(e,"AuthContext.login"),e}},p=async(e,t,o)=>{try{i.vF.logUserAction("register_attempt",{username:e,email:t});let r=await fetch(a.S.AUTH_REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,password:o})});if(!r.ok){let o=await r.json();throw i.vF.logUserAction("register_failed",{username:e,email:t,error:o.detail}),Error(o.detail||"Registration failed")}i.vF.logUserAction("register_success",{username:e,email:t}),await u(e,o)}catch(e){throw i.vF.logError(e,"AuthContext.register"),e}},E={user:o,token:c,login:u,register:p,logout:()=>{i.vF.logUserAction("logout",{userId:null==o?void 0:o.id}),localStorage.removeItem("token"),g(null),l(null)},loading:d,isAdmin:(null==o?void 0:o.is_admin)||!1,isAuthenticated:!!o};return(0,r.jsx)(s.Provider,{value:E,children:t})}}},e=>{var t=t=>e(e.s=t);e.O(0,[593,792],()=>(t(92),t(6296))),_N_E=e.O()}]);