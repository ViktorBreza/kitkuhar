"use strict";exports.id=575,exports.ids=[575],exports.modules={9375:(a,b,c)=>{c.d(b,{A:()=>h});var d=c(8732),e=c(2015),f=c(4233),g=c(3758);let h=({children:a,adminRequired:b=!1})=>{let{isAuthenticated:c,isAdmin:h,loading:i}=(0,g.A)(),j=(0,f.useRouter)();return((0,e.useEffect)(()=>{i||c||j.push("/login")},[c,i,j]),i)?(0,d.jsx)("div",{className:"container mt-4",children:(0,d.jsx)("div",{className:"text-center",children:(0,d.jsx)("div",{className:"spinner-border",role:"status",children:(0,d.jsx)("span",{className:"visually-hidden",children:"Завантаження..."})})})}):c?b&&!h?(0,d.jsx)("div",{className:"container mt-4",children:(0,d.jsxs)("div",{className:"alert alert-danger",role:"alert",children:[(0,d.jsx)("h4",{className:"alert-heading",children:"Доступ заборонено"}),(0,d.jsx)("p",{children:"У вас недостатньо прав для доступу до цієї сторінки."})]})}):(0,d.jsx)(d.Fragment,{children:a}):null}},9665:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{A:()=>l});var e=c(8732),f=c(2015),g=c(4233),h=c(1428),i=c(3758),j=c(2969),k=a([h]);h=(k.then?(await k)():k)[0];let l=({recipeId:a})=>{let[b,c]=(0,f.useState)({title:"",description:"",ingredients:[{name:"",quantity:1,unit:"шт"}],steps:"",servings:1,category:null,tags:[]}),[d,k]=(0,f.useState)([]),[l,m]=(0,f.useState)([]),[n,o]=(0,f.useState)(!1),[p,q]=(0,f.useState)(""),{token:r}=(0,i.A)(),s=(0,g.useRouter)();(0,f.useEffect)(()=>{(async()=>{try{let[a,b]=await Promise.all([h.default.get(`${j.S.CATEGORIES}`),h.default.get(`${j.S.TAGS}`)]);k(a.data),m(b.data)}catch(a){console.error("Error loading form data:",a)}})(),a&&(async()=>{try{let b=(await h.default.get(`${j.S.RECIPES}/${a}`)).data;Array.isArray(b.ingredients)||(b.ingredients=[{name:"",quantity:1,unit:"шт"}]),Array.isArray(b.tags)||(b.tags=[]),c(b)}catch(a){q("Не вдалося завантажити рецепт")}})()},[a]);let t=async c=>{if(c.preventDefault(),!b.title||!b.ingredients||0===b.ingredients.length||!b.category)return void q("Будь ласка, заповніть всі обов'язкові поля");o(!0),q("");try{let c={title:b.title,description:b.description,ingredients:b.ingredients?.filter(a=>""!==a.name.trim()),steps:"string"==typeof b.steps?b.steps:b.steps?.join("\n")||"",servings:b.servings,category_id:b.category?.id,tags:b.tags?.map(a=>a.id)||[]};a?await h.default.put(`${j.S.RECIPES}/${a}`,c,{headers:{Authorization:`Bearer ${r}`}}):await h.default.post(j.S.RECIPES,c,{headers:{Authorization:`Bearer ${r}`}}),s.push("/recipes")}catch(a){q("Помилка збереження рецепту"),console.error(a)}finally{o(!1)}},u=(a,d,e)=>{let f=[...b.ingredients||[]];f[a]={...f[a],[d]:e},c({...b,ingredients:f})};return(0,e.jsx)("div",{className:"card",children:(0,e.jsxs)("div",{className:"card-body",children:[p&&(0,e.jsx)("div",{className:"alert alert-danger",role:"alert",children:p}),(0,e.jsxs)("form",{onSubmit:t,children:[(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"title",className:"form-label",children:"Назва рецепту *"}),(0,e.jsx)("input",{type:"text",className:"form-control",id:"title",value:b.title||"",onChange:a=>c({...b,title:a.target.value}),required:!0})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"description",className:"form-label",children:"Опис"}),(0,e.jsx)("textarea",{className:"form-control",id:"description",rows:3,value:b.description||"",onChange:a=>c({...b,description:a.target.value})})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"servings",className:"form-label",children:"Кількість порцій"}),(0,e.jsx)("input",{type:"number",className:"form-control",id:"servings",min:"1",value:b.servings||1,onChange:a=>c({...b,servings:parseInt(a.target.value)})})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"category",className:"form-label",children:"Категорія *"}),(0,e.jsxs)("select",{className:"form-control",id:"category",value:b.category?.id||"",onChange:a=>{let e=parseInt(a.target.value),f=d.find(a=>a.id===e);c({...b,category:f||null})},required:!0,children:[(0,e.jsx)("option",{value:"",children:"Оберіть категорію"}),d.map(a=>(0,e.jsx)("option",{value:a.id,children:a.name},a.id))]})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"tags",className:"form-label",children:"Теги"}),(0,e.jsx)("div",{style:{maxHeight:"150px",overflowY:"auto",border:"1px solid #ced4da",borderRadius:"0.25rem",padding:"0.5rem"},children:l.map(a=>(0,e.jsxs)("div",{className:"form-check",children:[(0,e.jsx)("input",{className:"form-check-input",type:"checkbox",id:`tag-${a.id}`,checked:b.tags?.some(b=>b.id===a.id)||!1,onChange:d=>{let e=b.tags||[];d.target.checked?c({...b,tags:[...e,a]}):c({...b,tags:e.filter(b=>b.id!==a.id)})}}),(0,e.jsx)("label",{className:"form-check-label",htmlFor:`tag-${a.id}`,children:a.name})]},a.id))})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{className:"form-label",children:"Інгредієнти *"}),b.ingredients?.map((a,d)=>(0,e.jsxs)("div",{className:"row mb-2",children:[(0,e.jsx)("div",{className:"col-md-5",children:(0,e.jsx)("input",{type:"text",className:"form-control",placeholder:"Назва інгредієнта",value:a.name,onChange:a=>u(d,"name",a.target.value)})}),(0,e.jsx)("div",{className:"col-md-3",children:(0,e.jsx)("input",{type:"number",className:"form-control",placeholder:"Кількість",min:"0",step:"0.1",value:a.quantity,onChange:a=>u(d,"quantity",parseFloat(a.target.value))})}),(0,e.jsx)("div",{className:"col-md-3",children:(0,e.jsx)("input",{type:"text",className:"form-control",placeholder:"Одиниця",value:a.unit,onChange:a=>u(d,"unit",a.target.value)})}),(0,e.jsx)("div",{className:"col-md-1",children:(0,e.jsx)("button",{type:"button",className:"btn btn-outline-danger",onClick:()=>(a=>{let d=b.ingredients?.filter((b,c)=>c!==a);c({...b,ingredients:d})})(d),children:"\xd7"})})]},d)),(0,e.jsx)("button",{type:"button",className:"btn btn-outline-primary btn-sm",onClick:()=>{c({...b,ingredients:[...b.ingredients||[],{name:"",quantity:1,unit:"шт"}]})},children:"+ Додати інгредієнт"})]}),(0,e.jsxs)("div",{className:"mb-3",children:[(0,e.jsx)("label",{htmlFor:"steps",className:"form-label",children:"Інструкції з приготування *"}),(0,e.jsx)("textarea",{className:"form-control",id:"steps",rows:6,value:"string"==typeof b.steps?b.steps:"",onChange:a=>c({...b,steps:a.target.value}),placeholder:"Опишіть кроки приготування...",required:!0})]}),(0,e.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,e.jsx)("button",{type:"button",className:"btn btn-secondary",onClick:()=>s.back(),children:"Скасувати"}),(0,e.jsx)("button",{type:"submit",className:"btn btn-primary",disabled:n,children:n?"Збереження...":a?"Оновити рецепт":"Створити рецепт"})]})]})]})})};d()}catch(a){d(a)}})}};